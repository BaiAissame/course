name: ğŸ›’ VÃ©rification Liste de Courses

on:
  push:
    branches:
      - develop
      - main
  pull_request:

jobs:
  check-format:
    name: VÃ©rifier le format de la liste
    runs-on: ubuntu-latest

    steps:
      - name: Cloner le dÃ©pÃ´t
        uses: actions/checkout@v3

      - name: VÃ©rifier l'existence du fichier
        run: |
          if [ ! -f liste_courses.txt ]; then
            echo "âŒ Erreur : Le fichier liste_courses.txt est introuvable !"
            exit 1
          fi

      - name: VÃ©rifier et supprimer les lignes vides
        run: |
          grep -v '^[[:space:]]*$' liste_courses.txt > cleaned_liste_courses.txt
          mv cleaned_liste_courses.txt liste_courses.txt
          
          if git diff --exit-code liste_courses.txt; then
            echo "âœ… Aucun espace inutile dÃ©tectÃ©."
          else
            echo "âŒ Erreur : Des espaces inutiles ont Ã©tÃ© dÃ©tectÃ©s et supprimÃ©s."
            echo "Corrigez en exÃ©cutant : grep -v '^[[:space:]]*$' liste_courses.txt > temp && mv temp liste_courses.txt"
            exit 1
          fi

      - name: SuccÃ¨s !
        run: echo "âœ… La liste de courses est bien formatÃ©e !"
